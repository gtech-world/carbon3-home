(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[200],{1344:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/model",function(){return l(8725)}])},7921:function(e,t,l){"use strict";l.d(t,{z:function(){return r}});var n=l(1527),s=l(4875),a=l.n(s);function r(e){const{children:t,className:l,...s}=e;return(0,n.jsx)("button",{...s,className:a()(l,"hover:bg-green-28"),children:e.children})}},8503:function(e,t,l){"use strict";l.d(t,{P:function(){return m},d:function(){return x}});var n=l(1527),s=l(2132),a=l(4875),r=l.n(a),i=l(959),d=l(7067),c=l(9592),o=l(8723);function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[l,n]=(0,i.useState)(t);return(0,i.useEffect)((()=>{n(t)}),[e,t]),{onChange:n,items:e,current:l}}function m(e){const{items:t,current:l,onChange:a,className:x}=e,m=t[l]?t[l].text:"",[u,h]=(0,c.Z)(!1),g=(0,i.useCallback)((e=>{l!==e&&a(e)}),[l]),p=(0,s.E)("t-side");return(0,o.Z)(p,(()=>u&&h(!1))),0===t.length?null:(0,n.jsxs)("div",{ref:p,className:r()("bg-white text-black px-5 py-3 text-lg rounded-lg relative w-[31.25rem] cursor-pointer mo:w-full mo:text-sm",x),onClick:()=>h(),children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{children:m}),u?(0,n.jsx)(d.pzk,{}):(0,n.jsx)(d._i7,{})]}),u&&(0,n.jsx)("div",{className:"absolute left-0 w-full bg-white rounded-lg overflow-hidden py-3",style:{boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.15)",top:"calc(100% + 8px)"},children:t.map(((e,t)=>(0,n.jsx)("div",{style:{},className:r()("w-full px-5 py-2 text-sm",{"text-green-2":t===l}),onClick:()=>g(t),children:e.text},"select_item_".concat(t))))})]})}},8725:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return _}});var n=l(1527),s=l(7944),a=l(959),r=l(8288),i=l(3046),d=l(7921),c=l(9601),o=l(7361),x=l(3190),m=l(2699),u=l.n(m),h=l(4726),g=l(818),p=l(4875),f=l.n(p),j=l(1671),v=l(9592),b=l(8723),N=l(8370),w=l(9077);const y=(e,t,l,n)=>{var s;return{data:{id:e.id.toString(),isLeaf:!(null===e||void 0===e?void 0:e.children)||0===(null===e||void 0===e||null===(s=e.children)||void 0===s?void 0:s.length),isOpenByDefault:!0,name:e.name,nestingLevel:t,node:e,onSelect:e=>{l&&l(e)},onSwitch:()=>{n&&n(e)}},nestingLevel:t,node:e}};function C(e){const{style:t,data:{name:l,nestingLevel:s,isLeaf:a,node:r,onSelect:i,onSwitch:d},isOpen:c,setOpen:o}=e;return(0,n.jsxs)("div",{style:{...t,paddingLeft:"".concat(20*s,"px"),width:"max-content",paddingRight:20},className:f()("flex items-center py-[2px]",{}),children:[(0,n.jsx)("button",{onClick:()=>o(!c),className:f()("text-xl text-gray-9 mr-[4px]",{invisible:a}),children:c?(0,n.jsx)(j.ZXJ,{}):(0,n.jsx)(j.jfD,{})}),(0,n.jsx)("div",{onClick:()=>{a?i(r):(d(),o(!c))},className:f()("flex text-sm gap-1 items-center cursor-pointer"),children:(0,n.jsx)("span",{className:f()("text-black whitespace-nowrap"),children:l})})]})}function k(e){const{node:t=[],onChange:l,classname:s}=e,[r,i]=(0,a.useState)(),d=(0,a.useRef)(null),c=(0,a.useRef)(null),[o,x]=(0,v.Z)(!1),[m,u]=(0,a.useState)(20);(0,b.Z)(c,(()=>o&&x(!1))),(0,a.useMemo)((()=>{l&&l(r)}),[r]);const h=()=>{setTimeout((()=>{var e;const t=null===(e=d.current)||void 0===e?void 0:e.firstElementChild.firstElementChild;t&&u(parseInt(t.style.height))}),0)};(0,a.useMemo)((()=>{o&&h()}),[o]);const g=(0,a.useCallback)((function*(){for(let n=0;n<t.length;n++)yield y(t[n],0,(e=>{i(e),x(!1)}),(()=>{h()}));for(;;){var e,l;const t=yield;for(let n=0;n<(null===(e=t.node)||void 0===e||null===(l=e.children)||void 0===l?void 0:l.length);n++)yield y(t.node.children[n],t.nestingLevel+1,(e=>{i(e),x(!1)}),(()=>{h()}))}}),[t]);return(0,n.jsxs)("div",{className:"",ref:c,children:[(0,n.jsx)("div",{className:f()("w-full h-10 cursor-pointer rounded-lg flex items-center px-3",s),onClick:()=>x(!o),children:r?r.name:""}),o&&(0,n.jsx)(N.Z,{children:e=>{let{width:t}=e;return(0,n.jsx)("div",{className:"bg-white rounded-lg mt-2.5 p-5 absolute",ref:d,style:{boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.15)"},children:(0,n.jsx)(w.NC,{className:"",ref:d,useIsScrolling:!0,width:t-42,height:m,itemSize:22,treeWalker:g,children:C})})}})]})}var S=l(9270),E=l(8503),I=l(3273);var _=function(){var e,t,l,m,p;const[j,v]=(0,a.useState)(null),[b,N]=(0,a.useState)(null),[w,y]=(0,a.useState)(!1),[C,_]=(0,a.useState)(null),[T,L]=(0,a.useState)(!1),[z,D]=(0,a.useState)(1),[F,M]=(0,a.useState)(1),[O,P]=(0,a.useState)(""),[Z,R]=(0,a.useState)(null),[J,U]=(0,a.useState)(""),[X,B]=(0,a.useState)(null),[A,W]=(0,a.useState)(null),[q,G]=(0,a.useState)(""),[H,K]=(0,a.useState)(-1),[Q,V]=(0,a.useState)(-1),Y=(0,a.useRef)(null),{user:$}=(0,S.aF)(),ee=(0,x.useRouter)(),{toast:te}=(0,S.pm)(),{value:le,loading:ne}=(0,o.k)((0,h.Pf)((()=>Promise.all([(0,h.BI)({pgNum:z,productId:Q}),(0,h.Ps)(),(0,h.vz)()])),[z,F,Q]),[z,F,Q]);function se(e,t){return e.filter((e=>void 0===t?0===e.parentId:e.parentId===t)).map((t=>(t.children=se(e,t.id),t)))}const{tableData:ae,productType:re,productList:ie}=(0,a.useMemo)((()=>{var e;let t=[],l=[];return le?(le[0].records.map((e=>{console.log(JSON.parse(e.paramDetail)),t.push({id:e.id,modelName:e.modelName,modelUuid:e.modelUuid,productName:e.product.name,state:e.state,createTime:e.createTime,paramDetail:JSON.parse(e.paramDetail)[0].parameters.map((e=>{var t;return{context:e.name,parameter:e.context.name,amount:e.value,uncertainty:(null===e||void 0===e||null===(t=e.uncertainty)||void 0===t?void 0:t.distributionType)||null,description:e.description}}))})})),le[2].records.map((e=>{l.push({id:e.id,text:e.name,type:e.category.name,desc:e.description})})),{tableData:t,productType:le[1]?se(null===(e=le[1])||void 0===e?void 0:e.records,0):[],productList:l}):{tableData:t,productType:[],productList:[]}}),[le]),de=[{title:"\u6a21\u578b\u540d\u79f0",dataIndex:"modelName",width:"220px",render:e=>(0,n.jsx)("span",{className:"max-w-[220px] truncate inline-block","data-tooltip-id":"tooltip","data-tooltip-content":e,children:e})},{title:"\u6a21\u578bID",dataIndex:"modelUuid",render:e=>(0,n.jsx)("span",{"data-tooltip-id":"tooltip","data-tooltip-content":e,children:(0,I.lS)(e)})},{title:"\u4ea7\u54c1\u540d\u79f0",dataIndex:"productName",width:"190px",filter:e=>(0,n.jsxs)("ul",{className:"bg-white w-[12.375rem] max-h-[15.875rem] overflow-auto text-sm rounded-lg py-3",style:{boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.15)"},children:[(0,n.jsx)("li",{className:f()("py-2.5 px-5 hover:bg-[#F3F3F3] cursor-pointer",-1===Q&&"text-green-2"),onClick:()=>{V(-1),e()},children:"All"}),ie.map(((t,l)=>(0,n.jsx)("li",{onClick:()=>{V(t.id),e()},className:f()("py-1.5 hover:bg-[#F3F3F3] px-5 break-all cursor-pointer",Q===t.id&&"text-green-2"),children:t.text},"productList".concat(l))))]}),render:e=>(0,n.jsx)("span",{className:"max-w-[150px] truncate inline-block","data-tooltip-id":"tooltip","data-tooltip-content":e,children:e})},{title:"\u72b6\u6001",dataIndex:"state",render:e=>{let t="";switch(e){case 0:t="\u5f03\u7528";break;case 1:t="\u6fc0\u6d3b";break;case-1:t="\u8349\u7a3f"}return(0,n.jsx)("span",{children:t})}},{title:"\u4e0a\u4f20\u65f6\u95f4",dataIndex:"createTime"},{title:"",render:(e,t)=>(0,n.jsxs)("div",{className:"flex flex-1 justify-between text-green-2",children:[(0,n.jsx)("span",{className:"cursor-pointer",onClick:()=>{1===t.state&&ee.push("/model?id=".concat(t.id))},children:"\u67e5\u770b\u6a21\u578b"}),(0,n.jsx)("span",{className:"cursor-pointer",onClick:()=>N(t),children:"\u67e5\u770b\u5b9e\u666f\u6570\u636e"}),(0,n.jsx)("span",{className:"cursor-pointer",onClick:()=>v(t),children:"\u66f4\u6539\u72b6\u6001"})]})}],ce=async e=>{const t="\u66f4\u6539\u72b6\u6001";_({title:t,loading:!0}),await(0,h.pF)(j.id,e),M(F+1),_({title:t,loading:!1,resultText:"\u64cd\u4f5c\u6210\u529f"}),v(null)};(0,a.useMemo)((()=>{w||(B(null),W(null))}),[w]);const oe=(0,a.useMemo)((()=>!!A&&!!q&&X>-1),[A,q,X]),xe=(0,a.useMemo)((()=>!!O&&!!Z),[O,Z]);return(0,n.jsxs)(s.m,{className:"text-black flex flex-col justify-between flex-1",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h3",{className:"text-2xl font-semibold mt-8 flex justify-between items-center",children:[(0,n.jsx)("span",{children:"\u4ea7\u54c1\u5b9a\u4e49"}),(0,n.jsx)(d.z,{onClick:()=>L(!0),className:"text-lg bg-green-2 w-[7.25rem] text-white rounded-lg h-11 font-normal",children:"\u65b0\u5efa\u4ea7\u54c1"})]}),(0,n.jsx)("ul",{className:"flex flex-wrap ml-[-1.25rem]",children:ie.map(((e,t)=>(0,n.jsx)("li",{onClick:()=>K(t),className:f()("bg-white px-5 py-2.5 border rounded-lg ml-5 mt-5 cursor-pointer",H===t?"border-green-2":"border-white"),children:(0,n.jsx)("div",{className:"",children:e.text})},"productList".concat(t))))})]}),(0,n.jsxs)("h3",{className:"text-2xl font-semibold mt-6 flex justify-between items-center",children:[(0,n.jsx)("span",{children:"\u4ea7\u54c1\u78b3\u8db3\u8ff9\u6a21\u578b\u7ba1\u7406"}),(0,n.jsx)(d.z,{onClick:()=>y(!0),className:"text-lg bg-green-2 w-40 text-white rounded-lg h-11 font-normal",children:"\u4e0a\u4f20\u78b3\u8db3\u8ff9\u6a21\u578b"})]}),(0,n.jsx)("div",{className:"bg-white p-5 rounded-2xl text-base mt-5 leading-[1.625rem]",children:(0,n.jsx)(r.i,{columns:de,loading:ne,cellClassName:(e,t,l)=>l%2===0?"bg-gray-16 ".concat(0===t&&"rounded-l-lg"," ").concat(t===de.length-1&&"rounded-r-lg"):"",data:ae,className:"",headerStyle:{background:"#fff"}})})]}),(0,n.jsx)(c.t,{onChange:e=>{D(e)},className:"my-8",total:le&&(null===(e=le[0])||void 0===e?void 0:e.total)?le[0].total:0,pgSize:10,pgNum:z}),null!==j&&(0,n.jsx)(i.u_,{title:"\u66f4\u6539\u72b6\u6001",onClose:()=>v(null),children:(0,n.jsx)("div",{className:"flex",children:(null===C||void 0===C?void 0:C.loading)?(0,n.jsx)(g.g,{}):(0,n.jsxs)("div",{className:"flex flex-1",children:[j.state>-2&&(0,n.jsx)(d.z,{onClick:()=>ce(1===j.state?0:1),className:"text-lg bg-green-2 w-full text-white rounded-lg flex-1 h-11",children:1===j.state?"\u5f03\u7528":"\u6fc0\u6d3b"}),-1===j.state&&(0,n.jsx)(d.z,{onClick:()=>ce(-2),className:"text-lg border-2 border-green-2 ml-5 bg-green-2/10 w-full text-green-2 hover:text-white hover:bg-green-2 rounded-lg flex-1 h-11",children:"\u5220\u9664"})]})})}),!!b&&(0,n.jsx)(i.u_,{title:b.modelName+"\u6a21\u578b\u4e2d\u7684\u5b9e\u666f\u8f93\u5165\u9879",onClose:()=>N(null),children:(0,n.jsx)("div",{className:"flex w-[60rem] min-h-[300px]",children:(0,n.jsx)(r.i,{columns:[{title:"\u5b9e\u666f\u8f93\u5165\u9879",dataIndex:"context"},{title:"\u8fc7\u7a0b\u540d\u79f0",dataIndex:"parameter"},{title:"\u53c2\u8003\u503c",dataIndex:"amount"},{title:"\u4e0d\u786e\u5b9a\u6027",dataIndex:"uncertainty",emptyText:"-"},{title:"\u63cf\u8ff0",dataIndex:"description",emptyText:"-"}],data:b.paramDetail})})}),C&&(0,n.jsx)(i.u_,{title:(null===C||void 0===C?void 0:C.title)||"\u64cd\u4f5c",onClose:()=>_(null),children:(0,n.jsx)("div",{className:"text-center pb-2",children:C.loading?(0,n.jsx)(g.g,{}):(0,n.jsx)("span",{children:C.resultText})})}),T&&(0,n.jsxs)(i.u_,{title:"\u65b0\u5efa\u4ea7\u54c1",onClose:()=>L(!1),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("label",{className:"mr-2",children:"\u4ea7\u54c1\u540d\u79f0 :"}),(0,n.jsx)("input",{maxLength:30,type:"text",onChange:e=>(e=>{P(e.target.value)})(e),className:"border border-gray-14 bg-gray-28 w-[21.5rem] h-[3.125rem] rounded-lg px-3"})]}),(0,n.jsxs)("div",{className:"mt-6 flex items-center",children:[(0,n.jsx)("label",{className:"mr-2",children:"\u4ea7\u54c1\u7c7b\u578b :"}),(0,n.jsx)(k,{classname:"border border-gray-14 bg-gray-28 w-[21.5rem] h-[3.125rem]",onChange:e=>{R(e)},node:re})]}),(0,n.jsxs)("div",{className:"my-6 flex items-center",children:[(0,n.jsx)("label",{className:"mr-10",children:"\u63cf\u8ff0 :"}),(0,n.jsx)("input",{maxLength:100,className:"border border-gray-14 rounded-lg bg-gray-28 px-3 w-[21.5rem] h-[3.125rem]",onChange:e=>{U(e.target.value)}})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(d.z,{onClick:()=>L(!1),className:"text-lg flex-1 bg-green-2/10 border-2 border-green-2 text-green-2 w-40 text-white rounded-lg h-[2.875rem] font-normal hover:bg-green-28 hover:text-white",children:"\u53d6\u6d88"}),(0,n.jsx)(d.z,{onClick:()=>xe&&(async()=>{if(!(null===Z||void 0===Z?void 0:Z.id))return!1;if(u().find(ie,(e=>e.text===O)))return te({type:"error",msg:"\u4ea7\u54c1\u540d\u79f0\u5df2\u7ecf\u5b58\u5728"}),!1;const e="\u65b0\u5efa\u4ea7\u54c1";_({title:e,loading:!0}),L(!1),await(0,h.Mt)({name:O,categoryId:null===Z||void 0===Z?void 0:Z.id,orgId:$.orgId,description:J}),_({title:e,loading:!1,resultText:"\u64cd\u4f5c\u6210\u529f\uff01"}),M(F+1)})(),className:f()("text-lg ml-5 flex-1 bg-green-2 w-40 text-white rounded-lg h-[2.875rem] font-normal",!xe&&"bg-[#CECECE] hover:bg-[#CECECE]"),children:"\u786e\u5b9a"})]})]}),w&&(0,n.jsxs)(i.u_,{title:"\u4e0a\u4f20\u78b3\u8db3\u8ff9\u6a21\u578b",onClose:()=>y(!1),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("label",{className:"mr-2",children:"\u4ea7\u54c1\u540d\u79f0 : "}),(0,n.jsx)(E.P,{className:"border border-gray-14 bg-gray-28 w-[21.5rem] h-[3.125rem]",items:ie,current:X,onChange:e=>{B(e)}})]}),(0,n.jsxs)("div",{className:"flex items-center mt-6",children:[(0,n.jsx)("label",{className:"mr-2",children:"\u6a21\u578b\u540d\u79f0 : "}),(0,n.jsx)("input",{type:"text",maxLength:30,onChange:e=>{G(e.target.value)},className:"border border-gray-14 bg-gray-28 rounded h-[3.125rem] w-[21.5rem] px-3"})]}),(0,n.jsxs)("div",{className:"flex items-center my-6",children:[(0,n.jsx)("label",{className:"mr-2",children:"\u78b3\u8db3\u8ff9\u6a21\u578b : "}),(0,n.jsx)("div",{className:"cursor-pointer underline text-blue-0",onClick:()=>Y.current.click(),children:A?A.name:"\u9009\u62e9\u6587\u4ef6"})]}),(0,n.jsx)("input",{ref:Y,onChange:async e=>{W(e.target.files[0])},type:"file",hidden:!0}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(d.z,{onClick:()=>y(!1),className:"text-lg flex-1 bg-green-2/10 border-2 border-green-2 text-green-2 w-40 text-white rounded-lg h-[2.875rem] font-normal hover:bg-green-28 hover:text-white",children:"\u53d6\u6d88"}),(0,n.jsx)(d.z,{onClick:()=>oe&&(async()=>{const e=new FormData;e.append("name",q),e.append("file",A),e.append("productId",ie[X].id);const t="\u4e0a\u4f20\u78b3\u8db3\u8ff9\u6a21\u578b";_({title:t,loading:!0}),await(0,h.av)(e)?(_({title:t,loading:!1,resultText:"\u4e0a\u4f20\u6210\u529f\uff01"}),Y.current.value="",y(!1),M(F+1)):_({title:t,loading:!1,resultText:"\u4e0a\u4f20\u5931\u8d25\uff01"})})(),className:f()("text-lg ml-5 flex-1 bg-green-2 w-40 text-white rounded-lg h-[2.875rem] font-normal",!oe&&"bg-[#CECECE] hover:bg-[#CECECE]"),children:"\u786e\u5b9a"})]})]}),H>-1&&(0,n.jsx)(i.u_,{title:"\u67e5\u770b\u4ea7\u54c1",onClose:()=>K(-1),children:(0,n.jsxs)("ul",{className:"text-lg max-w-[32rem]",children:[(0,n.jsxs)("li",{className:"flex",children:[(0,n.jsx)("label",{className:"inline-block min-w-[5.625rem]",children:"\u4ea7\u54c1\u540d\u79f0 :"}),(0,n.jsx)("span",{className:"text-gray-6",children:null===(t=ie[H])||void 0===t?void 0:t.text})]}),(0,n.jsxs)("li",{className:"my-5",children:[(0,n.jsx)("label",{className:"inline-block w-[5.625rem]",children:"\u4ea7\u54c1\u7c7b\u578b :"}),(0,n.jsx)("span",{className:"text-gray-6",children:null===(l=ie[H])||void 0===l?void 0:l.type})]}),(0,n.jsxs)("li",{className:"flex",children:[(0,n.jsx)("label",{className:"inline-block min-w-[5.625rem]",children:"\u63cf\u8ff0 :"}),(0,n.jsx)("span",{className:"text-gray-6 break-all",children:(null===(m=ie[H])||void 0===m?void 0:m.desc)?null===(p=ie[H])||void 0===p?void 0:p.desc:"-"})]})]})})]})}}},function(e){e.O(0,[713,769,307,574,509,570,819,774,888,179],(function(){return t=1344,e(e.s=t);var t}));var t=e.O();_N_E=t}]);