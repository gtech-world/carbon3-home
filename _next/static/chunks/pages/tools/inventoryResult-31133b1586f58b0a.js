(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1126],{7959:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/inventoryResult",function(){return a(2545)}])},1191:function(e,t,a){"use strict";a.d(t,{z:function(){return s}});var n=a(1527),l=a(4875),r=a.n(l);function s(e){let{children:t,className:a,...l}=e;return(0,n.jsx)("button",{...l,className:r()(a,"hover:bg-green-28"),children:e.children})}},5858:function(e,t,a){"use strict";a.d(t,{I:function(){return c},g:function(){return i}});var n=a(1527),l=a(4875),r=a.n(l),s=a(1671);function i(e){let{className:t,color:a,size:l="",...i}=e;return(0,n.jsx)("div",{...i,className:r()("text-black w-full h-full flex items-center justify-center",t),children:(0,n.jsx)(s.uur,{color:a,style:{fontSize:l},className:"text-[3.125rem] animate-spin"})})}function c(){return(0,n.jsx)(i,{className:"fixed z-50 left-0 top-0 w-full !h-full bg-black/25"})}},9346:function(e,t,a){"use strict";a.d(t,{i:function(){return u}});var n=a(1527),l=a(4875),r=a.n(l),s=a(4323),i=a(1875),c=a(959),d=a(5858),o=a(8723);let u=e=>{let{columns:t,data:a,className:l,cellClassName:u,headerStyle:m,size:x,maxHeight:p,loading:f=!1,hiddenHeader:h=!1,mouseHoverKey:v="",columnsHeight:j=""}=e,[N,g]=(0,c.useState)(a||[]),[y,b]=(0,c.useState)({}),[w,I]=(0,c.useState)({}),k=(0,c.useRef)(null);(0,o.Z)(k,()=>{for(let e in y)y[e]&&(y[e].isFilterOpen=!1,b({...y}))}),(0,c.useEffect)(()=>{g(a)},[a]),(0,c.useEffect)(()=>{t.map(e=>{if(e.filterOptions){var t;y[e.dataIndex]={isFilterOpen:!1,filterValueIndex:(null===(t=y[e.dataIndex])||void 0===t?void 0:t.filterValueIndex)>-1?y[e.dataIndex].filterValueIndex:-1}}}),b(y)},[t]);let C=e=>{if(void 0===N[e].level&&(N[e].level=0),N[e].children.map(t=>{t.level=N[e].level+1}),N[e].open=!N[e].open,N[e].open)g(N.slice(0,e+1).concat(N[e].children).concat(N.slice(e+1)));else{let t=N[e].children.length;N[e].children.map(e=>{e.open&&(e.open=!1,t+=e.children.length)}),N.splice(e+1,t),g([...N])}},S=(e,t)=>{Object.assign(y,{[e.dataIndex]:{filterValueIndex:t,isFilterOpen:!1}}),e.onFilterChange&&e.onFilterChange(t>-1?e.filterOptions[t]:null),b(y)},F=e=>{y[e.dataIndex].isFilterOpen=!y[e.dataIndex].isFilterOpen,b({...y})};return(0,n.jsxs)("div",{className:r()("w-full",l,"small"===x&&"text-xs","big"===x&&"text-lg mo:text-[.9375rem] "),children:[(0,n.jsxs)("table",{className:"w-full text-left ",children:[!h&&(0,n.jsx)("thead",{className:r()("bg-gray-14 ",l,"small"===x&&"text-sm"),style:m,children:(0,n.jsx)("tr",{className:"px-3",children:t&&t.map((e,a)=>{var l;return(0,n.jsxs)("th",{style:{width:e.width?e.width:"auto"},className:r()("px-3 relative break-keep",0===a&&"rounded-l overflow-hidden",a===t.length-1&&"rounded-r overflow-hidden","small"===x?"py-1":"big"===x?"py-3":"py-2"),children:[!!e.tip&&(0,n.jsx)(s.gL9,{"data-tooltip-id":"tooltip","data-tooltip-content":e.tip,className:"inline-block text-xl mt-[-0.15rem] mr-1"}),(0,n.jsx)("span",{children:e.title}),!!y[e.dataIndex]&&(0,n.jsxs)("div",{className:"inline-block",ref:k,children:[(0,n.jsx)(i.Ihx,{color:(null===(l=y[e.dataIndex])||void 0===l?void 0:l.filterValueIndex)>-1?"#29953A":"",onClick:()=>{F(e)},className:"inline-block text-xl mt-[-0.15rem] ml-1 cursor-pointer"}),y[e.dataIndex].isFilterOpen&&(0,n.jsx)("div",{className:"absolute left-0 font-normal top-10",children:(0,n.jsxs)("ul",{className:"bg-white w-[12.375rem] max-h-[14.875rem] overflow-auto text-sm rounded-lg py-3",style:{boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.15)"},children:[(0,n.jsx)("li",{className:r()("py-2.5 px-5 hover:bg-[#F3F3F3] cursor-pointer",-1===y[e.dataIndex].filterValueIndex&&"text-green-2"),onClick:()=>{S(e,-1)},children:"All"}),e.filterOptions.map((t,a)=>(0,n.jsx)("li",{onClick:()=>{S(e,a)},className:r()("py-1.5 hover:bg-[#F3F3F3] px-5 break-all cursor-pointer",y[e.dataIndex].filterValueIndex===a?"text-green-2":""),children:t.text},"productList".concat(a)))]})})]})]},"columns".concat(a))})})}),!f&&(0,n.jsx)("tbody",{style:{maxHeight:p},className:"w-full overflow-y-auto ",children:N.map((e,a)=>(0,n.jsx)("tr",{className:"column-level-".concat(e.level?e.level:0," ").concat(j),children:t.map((t,l)=>(0,n.jsx)("td",{className:r()("px-3 cursor-pointer  ",w[v]===e[v]?" bg-[#F3F3F3]":"","small"===x?"py-1":"big"===x?"py-3":"py-2",!!t.tip&&"pl-9",u&&u(t,l,a)),style:{width:t.width?t.width:"auto"},children:(0,n.jsxs)("div",{onMouseOver:()=>I(e),className:"flex items-center",style:{marginLeft:(e.level&&0===l?e.level:0)*1.25+"rem"},children:[!!(null==e?void 0:e.children)&&(null==e?void 0:e.children.length)>0&&0===l&&(0,n.jsx)(i.Tfp,{onClick:()=>C(a),className:r()("mr-2 cursor-pointer text-gray-9",e.open&&"rotate-[90deg]")}),t.render?t.render(e[t.dataIndex],e):t.emptyText&&!e[t.dataIndex]?"-":e[t.dataIndex]]})},"data_column_".concat(l)))},"table_data_".concat(a)))})]}),f?(0,n.jsx)(d.g,{className:"pt-8"}):!(N&&N.length>0)&&(0,n.jsx)("div",{className:"flex justify-center w-full py-20",children:"无数据"})]})}},1600:function(e,t,a){"use strict";a.d(t,{m:function(){return h}});var n=a(1527),l=a(8948),r=a(7265),s=a(1875),i=a(834),c=a(4875),d=a.n(c),o=a(7478),u=a(2810),m=a(8189),x=a(5487),p=a(5283);function f(e){let{children:t,className:a,tits:r,showQuery:s,isManager:c,...f}=e,{push:h}=(0,l.useRouter)(),v=(0,p.fo)();return(0,i.dD)(),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:d()("w-full relative z-[3] max-w-[90rem] mx-auto text-white flex items-center top-0 px-[7.5rem] h-[4.25rem] justify-between",a),...f,children:[(0,n.jsxs)("div",{className:"flex items-center cursor-pointer ml-[-1rem] mo:ml-0",onClick:()=>h("/"),children:[(0,n.jsx)(o.Z,{className:"h-[2.275rem] mo:h-[2rem]"}),(0,n.jsx)(u.Z,{className:"h-[1.5rem] mt-2.5 ml-3 mo:h-[1.1rem] mo:mt-3"})]}),(0,n.jsx)(m.R,{menus:v,children:(0,n.jsx)("button",{className:"text-[2rem] mo:text-2xl",children:(0,n.jsx)(x.otZ,{})})})]})})}function h(e){let{className:t,canBack:a,children:i,isNew:c,...o}=e,{push:u,pathname:m}=(0,l.useRouter)(),x=(0,r.R)();return(0,n.jsxs)("div",{className:"relative flex flex-col flex-1 w-full h-full min-h-fit bg-gray-16",children:[(0,n.jsx)(f,{showQuery:!0,style:{top:"".concat(x,"px")},className:"!sticky px-[3.125rem] py-4 !max-w-none bg-green-2 mo:px-4 mo:h-[4.25rem]"}),(0,n.jsxs)("div",{className:d()("w-full h-full mx-auto px-[60px] flex flex-col flex-1",{" max-w-[90rem]":!c}),children:[a&&(0,n.jsxs)("div",{className:"flex items-center my-5 text-sm cursor-pointer",onClick:()=>u("/carbon/service"),children:[(0,n.jsx)(s.YFh,{className:"text-lg"}),"返回"]}),(0,n.jsx)("div",{className:d()("flex flex-col ",t),children:i})]})]})}},5913:function(e,t,a){"use strict";a.d(t,{k:function(){return r}});var n=a(959),l=a(6171);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=(0,n.useRef)(!0),r=(0,n.useRef)(0),[,s]=(0,n.useState)(1),i=(0,n.useCallback)(e=>{a.current=e,s(e=>1-e)},[]),[c,d]=(0,l.Z)(e,t),o=()=>{a.current||i(!0);let e=r.current+1>1e5?0:r.current+1;r.current=e,d().finally(()=>r.current==e&&i(!1))};return(0,n.useEffect)(()=>{o()},t),(0,n.useMemo)(()=>({...c,value:a.current||c.error?void 0:c.value,loading:a.current,req:o}),[c,a.current])}},6699:function(e,t,a){"use strict";a.d(t,{AC:function(){return O},BI:function(){return N},Ii:function(){return j},Iv:function(){return _},LW:function(){return A},Mt:function(){return k},Pf:function(){return d},Ps:function(){return I},RN:function(){return f},RS:function(){return x},SO:function(){return g},Vd:function(){return h},av:function(){return w},eO:function(){return p},ep:function(){return v},fF:function(){return y},jw:function(){return m},pF:function(){return b},vz:function(){return C},x4:function(){return o}});var n=a(834),l=a(8422),r=a(58),s=a(9701);function i(e){return"".concat(r.Sg).concat(e)}function c(e){var t;let a=e.data;if(a){if(a.code&&1e5!==a.code)throw a.message;return null===(t=e.data)||void 0===t?void 0:t.data}}function d(e,t){return()=>t.some(e=>!e)?(0,s._v)():e()}async function o(e,t){let a=await l.default.post(i("/api/base/login"),{name:e,password:t});return c(a)}function u(){let e=(0,n.is)();return e?{headers:{Authorization:"Bearer ".concat(e.loginToken)}}:{}}async function m(){let e=await l.default.get(i("/api/npi/product/list"),u());return c(e)}async function x(e){let t=await l.default.get(i("/api/npi/product/".concat(e,"/pcf_accountable")),u());return c(t)}async function p(e){let t=await l.default.get(i("/api/npi/product/".concat(e,"/bom/list")),u());return c(t)}async function f(e){let t=await l.default.get(i("/api/npi/product_bom/".concat(e,"/activity_types")),u());return c(t)}async function h(e){let t=await l.default.get(i("/api/npi/product_process/query"),{...u(),params:{product_id:e,include_activity_types:!0}});return c(t)}async function v(e){let t=await l.default.get(i("/api/npi/product/serial_number/".concat(e,"/info")),u());return c(t)}async function j(e){let t=await l.default.get(i("/api/inventory/product/".concat(e,"/inventory")),u());return c(t)}async function N(e){let{pgNum:t,productId:a}=e,n=await l.default.get(i("/api/product-lca/model/query?pageNum=".concat(t,"&pageSize=10&productId=").concat(a>-1?a:"")),u());return c(n)}async function g(e){let{pgNum:t}=e,a=await l.default.get(i("/api/product-lca/result/query?pageNum=".concat(t,"&pageSize=10")),u());return c(a)}async function y(e){let t=await l.default.get(i("/api/product-lca/result/detail/".concat(e)),u());return c(t)}async function b(e,t){let a=await l.default.post(i("/api/product-lca/model/state/".concat(e,"/update/").concat(t)),null,u());return c(a)}async function w(e){let t=u();t.headers&&(t.headers["Content-Type"]="multipart/form-data");try{return await l.default.post(i("/api/product-lca/model/upload"),e,t)}catch(e){}}async function I(){let e=await l.default.get(i("/api/product/category/query"),u());return c(e)}async function k(e){let{name:t,categoryId:a,orgId:n,description:r}=e,s=await l.default.post(i("/api/product/upsert"),{name:t,categoryId:a,orgId:n,partNumber:"1",imageUrl:"",description:r},u());return c(s)}async function C(){let e=await l.default.get(i("/api/product/list?pageSize=500"),u());return c(e)}async function S(e){let t=await l.default.get(i("/api/product-lca/model/".concat(e,"/descriptors")),u());return JSON.parse(c(t))}async function F(e){let t=await l.default.get(i("/api/product-lca/model/".concat(e,"/categories")),u());return JSON.parse(c(t))}async function _(e){let t=await F(e),a=await S(e);return[t,a]}async function O(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=await l.default.get(i("/api/product-lca/model/".concat(e,"/item/").concat(t,"/").concat(a,"/info?fromMethod=").concat(n)),u());return JSON.parse(c(r))}async function A(e){let t=u(),a=await l.default.get(i("/api/product-lca/result/".concat(e,"/export")),Object.assign(t,{responseType:"blob"}));return a}},2545:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var n=a(1527),l=a(1600),r=a(959),s=a(1191),i=a(2702),c=a(4875),d=a.n(c),o=a(3378);function u(e){return(0,n.jsx)(o.Z,{opts:{locale:"en"},notMerge:!0,lazyUpdate:!0,...e})}var m=a(9346),x=a(7661),p=a(1875),f=a(1671),h=a(5591),v=a(5913),j=a(6699),N=a(9701),g=a(8948),y=a(5858);function b(e){let[t,a]=(0,r.useState)(!0),{text:l,onChange:s}=e;return(0,r.useMemo)(()=>{s&&s(t)},[t]),(0,n.jsx)("div",{className:"font-bold inline-block",onClick:()=>a(!t),children:(0,n.jsxs)("div",{className:"flex items-center cursor-pointer",children:[(0,n.jsx)("span",{children:l}),(0,n.jsx)(i.Tgc,{height:"7px",className:d()("ml-1",!t&&"rotate-180")})]})})}function w(e){let{data:t}=e,a=[{label:"产品批次号",text:t.loadNumber},{label:"产品名称",text:t.productName},{label:"模型名称",text:t.modelName},{label:"类别",text:t.productCategory},{label:"最后更改时间",text:t.lastUpdatedTime},{label:"UUID",text:t.uuid}];return(0,n.jsx)("div",{className:"bg-white p-5 rounded-2xl mt-8",children:a.map((e,t)=>(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("label",{className:"font-medium whitespace-nowrap",children:[e.label," :"]}),(0,n.jsx)("span",{className:"ml-1 text-gray-6",children:e.text})]},"data-".concat(t)))})}function I(e){let[t,a]=(0,r.useState)(!0),{data:l}=e,s=[{label:"产品系统",text:l.productSystemName},{label:"分配方法",text:"As defined in processes"},{label:"目标数量",text:l.targetAmount},{label:"影响评价方法",text:l.methodName},{label:"影响类别",text:"IPCC 2021 GWP 100"}];return(0,n.jsxs)("div",{children:[(0,n.jsx)(b,{text:"一般信息",onChange:e=>a(e)}),t&&(0,n.jsx)("div",{className:"mt-4",children:s.map((e,t)=>(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("label",{className:"",children:[e.label," :"]}),(0,n.jsx)("span",{className:"ml-1 text-gray-6",children:e.text})]},"data-".concat(t)))})]})}function k(e){let[t,a]=(0,r.useState)(!0),{data:l}=e;return(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(b,{text:"碳足迹结果",onChange:e=>a(e)}),t&&(0,n.jsx)("div",{className:"text-[1.75rem] font-semibold mt-4",children:l})]})}function C(e){let[t,a]=(0,r.useState)(!0),{data:l,referenceUnit:s}=e,i=[{title:"贡献",dataIndex:"contribution",width:"100px"},{title:"过程",dataIndex:"process",render:e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(x.G3d,{className:"svg-purple"}),(0,n.jsx)("span",{className:"ml-1",children:e})]})},{title:"所需数量",dataIndex:"requiredAmount"},{title:"结果",dataIndex:"result",render:e=>(0,n.jsxs)("span",{children:[e,"m3"===s?(0,n.jsxs)("span",{children:["m",(0,n.jsx)("sup",{children:"3"})]}):s]})}],c=(0,r.useMemo)(()=>{var e;let t=(null===(e=l[0])||void 0===e?void 0:e.children)||[],a=["#EB505B","#4780C6","#FFCE5D","#3F9F4A","#7B41A0","#757475"],n=[],r=[],i=0;t.map((e,t)=>{if(t<5){let l=e.result+" "+s+": "+e.process;n.push(l);let i=[0];for(let a=0;a<=t;a++)a<t?i.push(0):i.push(e.result);r.push({name:l,color:a[t],type:"bar",barWidth:40,data:i,barGap:"-100%"})}else i+=e.result||0});let c=i+" "+s+": other";return n.push(c),r.push({name:c,color:"#757475",type:"bar",barWidth:40,barGap:"-100%",data:[0,0,0,0,0,0,i]}),{grid:{top:20,left:50,right:790,bottom:20},xAxis:{type:"category",axisLine:{show:!0,lineStyle:{color:"#999999"}},axisTick:{show:!1},axisLabel:{show:!1}},legend:{orient:"vertical",right:0,y:"center",data:n,itemHeight:6,itemWidth:40,itemGap:20,textStyle:{padding:6}},yAxis:{type:"value",axisLine:{show:!0,lineStyle:{color:"#999999"}},splitLine:{show:!1},axisTick:{show:!0,length:5}},series:r}},[l]);return(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(b,{text:"贡献树",onChange:e=>a(e)}),t&&(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(m.i,{size:"small",columns:i,data:l,cellClassName:(e,t,a)=>a%2==0?"bg-gray-16 ".concat(0===t&&"rounded-l-md"," ").concat(t===i.length-1&&"rounded-r-md"):"",headerStyle:{background:"#fff"}})}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("h4",{children:"对影响类别结果的前5个贡献 - 概述"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)("div",{style:{minWidth:"1200px"},children:(0,n.jsx)(u,{style:{width:"100%"},option:c})})})]})]})]})}function S(e){let[t,a]=(0,r.useState)(!0),{data:l}=e,s=[{title:"名称",dataIndex:"name",render:e=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(f.J9I,{fill:"#29953A",className:"text-sm"}),(0,n.jsx)("span",{className:"ml-1",children:e})]}),width:"40%"},{title:"种类",dataIndex:"category",width:"30%"},{title:"数量",dataIndex:"amount",width:"20%"},{title:"单位",dataIndex:"unit",width:"10%"}];return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(b,{text:"清单列表",onChange:e=>a(e)}),t&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"mt-4 mb-3",children:"输入"}),(0,n.jsx)("ul",{className:"flex mb-1",children:s.map((e,t)=>(0,n.jsx)("li",{className:"px-3 text-sm font-bold",style:{width:e.width},children:e.title},"columns".concat(t)))}),(0,n.jsx)("div",{className:"max-h-[15rem] overflow-y-auto",children:(0,n.jsx)(m.i,{size:"small",hiddenHeader:!0,columns:s,data:l.inputData,cellClassName:(e,t,a)=>a%2==0?"bg-gray-16 ".concat(0===t&&"rounded-l"," ").concat(t===s.length-1&&"rounded-r"):"",headerStyle:{background:"#fff"},maxHeight:"300px"})}),(0,n.jsx)("h4",{className:"mt-4 mb-3",children:"输出"}),(0,n.jsxs)("div",{className:"max-h-[20rem] overflow-y-auto",children:[(0,n.jsx)("ul",{className:"flex mb-1",children:s.map((e,t)=>(0,n.jsx)("li",{className:"px-3 text-sm font-bold",style:{width:e.width},children:e.title},"columns".concat(t)))}),(0,n.jsx)("div",{className:"max-h-[15rem] overflow-y-auto",children:(0,n.jsx)(m.i,{size:"small",hiddenHeader:!0,columns:s,data:l.outputData,cellClassName:(e,t,a)=>a%2==0?"bg-gray-16 ".concat(0===t&&"rounded-l"," ").concat(t===s.length-1&&"rounded-r"):"",headerStyle:{background:"#fff"}})})]})]})]})})}function F(e){let[t,a]=(0,r.useState)(!0),{data:l}=e,s=[{title:"过程",dataIndex:"process",render:(e,t)=>(0,n.jsxs)("div",{className:"flex items-center",children:[t.children?(0,n.jsx)(h.$nz,{fill:"#9C27B0",className:"text-sm"}):(0,n.jsx)(x.G3d,{className:"svg-purple"}),(0,n.jsx)("span",{className:"ml-1",children:e})]}),width:"40%"},{title:"产品",dataIndex:"product",render:e=>e?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(p.nbt,{stroke:"#0084FF",className:"svg-blue text-sm"}),(0,n.jsx)("span",{className:"ml-1",children:e})]}):"",width:"30%"},{title:"数量",dataIndex:"amount",width:"20%"},{title:"单位",dataIndex:"unit",width:"10%"}];return(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(b,{text:"总需求",onChange:e=>a(e)}),t&&(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("ul",{className:"flex mb-1",children:s.map((e,t)=>(0,n.jsx)("li",{className:"px-3 text-sm font-bold",style:{width:e.width},children:e.title},"columns".concat(t)))}),(0,n.jsx)("div",{className:"max-h-[15rem] overflow-y-auto",children:(0,n.jsx)(m.i,{hiddenHeader:!0,size:"small",columns:s,data:l,cellClassName:(e,t,a)=>a%2==0?"bg-gray-16 ".concat(0===t&&"rounded-l"," ").concat(t===s.length-1&&"rounded-r"):"",headerStyle:{background:"#fff"}})})]})]})}var _=function(){let{query:e}=(0,g.useRouter)(),[t,a]=(0,r.useState)(!1),{value:i,loading:c}=(0,v.k)((0,j.Pf)(()=>(0,j.fF)(e.id),[]),[]),d=(e,t)=>0===e||0===t?0:t<0&&e>0?-(e/t):e/t,{baseInfo:o,generalInfo:u,carbonResult:m,contributeTreeData:x,referenceUnit:p,listData:f,totalRequire:h}=(0,r.useMemo)(()=>{let e=[],t=[],a=[],l="",r={loadNumber:"",productName:"",modelName:"",lastUpdatedTime:"",productCategory:"",desc:"",uuid:""},s="",c={inputData:[],outputData:[]};if(i){var o,u,m,x,p,f,h,v,j,g;r={loadNumber:i.loadNumber,productName:i.product.name,modelName:i.model.modelName,lastUpdatedTime:i.model.updateTime,productCategory:i.productCategory.name,desc:i.model.description,uuid:i.model.productSystemUuid};let y=(0,N.tV)(JSON.parse(i.lcaResult));t={productSystemName:null===(o=y.extra)||void 0===o?void 0:o.productSystemName,methodName:null===(u=y.extra)||void 0===u?void 0:u.methodName,targetAmount:null===(m=y.extra)||void 0===m?void 0:m.targetAmount},l=y.totalImpacts[0].impact.referenceUnit||"";let b=null===(x=y.treeNode)||void 0===x?void 0:x.result;e=[{contribution:(100*d(b,b)).toFixed(2)+"%",process:null===(p=y.treeNode)||void 0===p?void 0:p.provider.name,requiredAmount:(null===(f=y.treeNode)||void 0===f?void 0:f.requiredAmount)+" "+(null===(h=y.treeNode)||void 0===h?void 0:h.refUnit),result:null===(v=y.treeNode)||void 0===v?void 0:v.result}],s=(0,n.jsxs)("span",{children:[b||0,"m3"===l?(0,n.jsxs)("span",{children:["m",(0,n.jsx)("sup",{children:"3"})]}):l]});let w=e=>{e&&e.map(e=>{e.contribution=(100*d(e.result,b)).toFixed(2)+"%",e.process=e.provider.name,e.requiredAmount=e.requiredAmount+" "+e.refUnit,e.children&&e.children.length>0&&w(e.children)})};w(null===(j=y.treeNode)||void 0===j?void 0:j.children.sort((e,t)=>t.result-e.result)),e[0].children=null===(g=y.treeNode)||void 0===g?void 0:g.children,y.totalFlows.map(e=>{let t={name:e.flow.name,category:e.flowPropertyPath,amount:e.value,unit:e.refUnit};e.isInput?c.inputData.push(t):c.outputData.push(t)}),y.totalRequirements.map(e=>{a.push({process:e.provider.name,product:e.flow.name,amount:e.value,unit:e.refUnit})})}return{baseInfo:r,generalInfo:t,carbonResult:s,contributeTreeData:e,referenceUnit:l,listData:c,totalRequire:a}},[i]),b=async()=>{if(!e.id)return!1;a(!0);let t=await (0,j.LW)(e.id);a(!1);let n=new Blob([t.data]),l="".concat(u.productSystemName,".xlsx"),r=document.createElement("a");r.download=l,r.style.display="none",r.href=URL.createObjectURL(n),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)};return(0,n.jsx)(l.m,{className:"text-black text-lg",children:c?(0,n.jsx)("div",{className:"h-[100vh] w-full items-center",children:(0,n.jsx)(y.g,{})}):(0,n.jsxs)("div",{className:"mo:break-all",children:[(0,n.jsx)(w,{data:o}),(0,n.jsx)("h3",{className:"text-2xl font-semibold my-5",children:"碳足迹结果"}),(0,n.jsxs)("div",{className:"bg-white p-5 rounded-2xl",children:[(0,n.jsx)(I,{data:u}),(0,n.jsx)(k,{data:m}),(0,n.jsx)(C,{data:x,referenceUnit:p}),(0,n.jsx)(S,{data:f}),(0,n.jsx)(F,{data:h})]}),(0,n.jsx)("div",{className:"w-full flex justify-center mt-5 mb-10",children:(0,n.jsx)(s.z,{onClick:()=>!t&&b(),className:"mt-5 text-lg bg-green-2 w-[26.875rem] text-white rounded-lg  h-14 flex items-center justify-center",children:t?(0,n.jsx)("div",{children:(0,n.jsx)(y.g,{size:"2rem",color:"#fff"})}):(0,n.jsx)("span",{children:"导出Excel"})})})]})})}}},function(e){e.O(0,[713,769,7307,6574,6740,4798,1420,5137,2351,9774,2888,179],function(){return e(e.s=7959)}),_N_E=e.O()}]);