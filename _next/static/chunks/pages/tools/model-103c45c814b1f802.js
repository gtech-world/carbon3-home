(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8200],{6220:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/model",function(){return l(5187)}])},4956:function(e,t,l){"use strict";l.d(t,{E:function(){return s},K:function(){return r}});var n=l(3342),a=l(8591),i=l.n(a);function s(e){let{value:t,bg:l="#dddddd",color:a="#29953A",className:s}=e;return(0,n.jsx)("div",{className:i()(s,"w-full h-[10px]"),style:{background:l},children:(0,n.jsx)("div",{style:{width:"".concat(t,"%"),transition:"width 200ms ease",background:a},className:"h-full"})})}function r(e){let{index:t,full:l,bg:a="#dddddd",color:s="#29953A",className:r}=e;return(0,n.jsx)("div",{className:i()(r,"w-full h-[10px]"),style:{background:a},children:(0,n.jsx)("div",{style:{marginLeft:l?"0":"".concat(25*t,"%"),width:l?"100%":"25%",background:s},className:"h-full"})})}},5109:function(e,t,l){"use strict";l.d(t,{b:function(){return i}});var n=l(1083),a=l.n(n);let i=a()(()=>Promise.all([l.e(6257),l.e(8407),l.e(9253)]).then(l.bind(l,9367)),{loadableGenerated:{webpack:()=>[9367]},ssr:!1})},8469:function(e,t,l){"use strict";l.d(t,{d:function(){return c}});var n=l(3342),a=l(9455),i=l(9685);function s(){return(0,n.jsx)("tr",{className:"text-lg font-normal text-center text-black ",children:(0,n.jsx)("td",{colSpan:100,className:"h-[100px] py-5 align-top",children:"无数据"})})}var r=e=>{let{header:t,data:l,empty:a=(0,n.jsx)(s,{}),className:i="relative min-w-full bg-neutral-200 ",headerClassName:r="bg-neutral-200 sticky top-0 text-left text-black text-lg font-bold leading-[27px]",headerItemClassName:o="p-3",tbodyClassName:d="bg-white ",rowClassName:u="text-black text-sm font-normal whitespace-nowrap",cellClassName:c="p-3"}=e;return(0,n.jsxs)("table",{className:i,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{className:r,children:t.map((e,t)=>(0,n.jsx)("th",{scope:"col",className:o,children:e},t))})}),(0,n.jsxs)("tbody",{className:d,children:[l.map((e,t)=>(0,n.jsx)("tr",{className:u,children:e.map((e,t)=>(0,n.jsx)("td",{className:c,children:e},t))},t)),0===l.length&&a]})]})},o=l(5819),d=l(7207),u=l.n(d);function c(e){let{data:t,inputData:l,header:s=["参数名","过程名称","参考值","输入值"],...d}=e,c=(0,i.useMemo)(()=>{var e;if(!t)return[];let n=l?u().mapKeys("string"==typeof l?(0,o.OA)(l)||[]:l,e=>e.paramName):{},a=(0,o.OA)(t)||[],i=(null===(e=a[0])||void 0===e?void 0:e.parameters)||[];return i.map(e=>{var t;return[e.name,e.context.name,e.value,(null===(t=n[e.name])||void 0===t?void 0:t.paramValue)||""]})},[t,l]);return(0,n.jsx)(a.u_,{title:"实景数据",...d,children:(0,n.jsx)("div",{className:"w-[40rem] px-5 max-h-mc overflow-y-auto",children:(0,n.jsx)(r,{data:c,header:s})})})}},9749:function(e,t,l){"use strict";l.d(t,{H4:function(){return r},Kv:function(){return s},Tz:function(){return d},We:function(){return o}});var n=l(7207),a=l.n(n),i=l(6631);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,i.ZP)("/api/product-system/".concat(e,"/detail"),{refreshInterval:t})}function r(e){return(0,i.ZP)(a().isNil(e)?null:"/api/verifyRecord/".concat(e,"/detail"))}function o(e){return(0,i.ZP)(e?"/api/inventory/all":null)}function d(e){return(0,i.ZP)(e?"/api/verifyRecord/verifiers":null)}},2957:function(e,t,l){"use strict";l.d(t,{o:function(){return a}});var n=l(9685);function a(){let e=(0,n.useRef)(!0);return(0,n.useEffect)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}},9976:function(e,t,l){"use strict";l.d(t,{b:function(){return i},n:function(){return a}});var n=l(3958);function a(){let{userData:e,inited:t}=(0,n.oR)();return t&&(null==e?void 0:e.role)==="verify"}function i(){let{userData:e,inited:t}=(0,n.oR)();return t&&(null==e?void 0:e.role)!=="verify"}},1362:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{noSSR:function(){return s},default:function(){return r}});let n=l(4035),a=(l(9685),n._(l(3441)));function i(e){return{default:(null==e?void 0:e.default)||e}}function s(e,t){return delete t.webpack,delete t.modules,e(t)}function r(e,t){let l=a.default,n={loading:e=>{let{error:t,isLoading:l,pastDelay:n}=e;return null}};e instanceof Promise?n.loader=()=>e:"function"==typeof e?n.loader=e:"object"==typeof e&&(n={...n,...e}),n={...n,...t};let r=n.loader;return(n.loadableGenerated&&(n={...n,...n.loadableGenerated},delete n.loadableGenerated),"boolean"!=typeof n.ssr||n.ssr)?l({...n,loader:()=>null!=r?r().then(i):Promise.resolve(i(()=>null))}):(delete n.webpack,delete n.modules,s(l,n))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8529:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return i}});let n=l(4035),a=n._(l(9685)),i=a.default.createContext(null)},3441:function(e,t,l){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return x}});let n=l(4035),a=n._(l(9685)),i=l(8529),s=[],r=[],o=!1;function d(e){let t=e(),l={loading:!0,loaded:null,error:null};return l.promise=t.then(e=>(l.loading=!1,l.loaded=e,e)).catch(e=>{throw l.loading=!1,l.error=e,e}),l}class u{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function c(e){return function(e,t){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),n=null;function s(){if(!n){let t=new u(e,l);n={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return n.promise()}if(!o){let e=l.webpack?l.webpack():l.modules;e&&r.push(t=>{for(let l of e)if(t.includes(l))return s()})}function d(e,t){!function(){s();let e=a.default.useContext(i.LoadableContext);e&&Array.isArray(l.modules)&&l.modules.forEach(t=>{e(t)})}();let r=a.default.useSyncExternalStore(n.subscribe,n.getCurrentValue,n.getCurrentValue);return a.default.useImperativeHandle(t,()=>({retry:n.retry}),[]),a.default.useMemo(()=>{var t;return r.loading||r.error?a.default.createElement(l.loading,{isLoading:r.loading,pastDelay:r.pastDelay,timedOut:r.timedOut,error:r.error,retry:n.retry}):r.loaded?a.default.createElement((t=r.loaded)&&t.default?t.default:t,e):null},[e,r])}return d.preload=()=>s(),d.displayName="LoadableComponent",a.default.forwardRef(d)}(d,e)}function m(e,t){let l=[];for(;e.length;){let n=e.pop();l.push(n(t))}return Promise.all(l).then(()=>{if(e.length)return m(e,t)})}c.preloadAll=()=>new Promise((e,t)=>{m(s).then(e,t)}),c.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let l=()=>(o=!0,t());m(r,e).then(l,l)})),window.__NEXT_PRELOADREADY=c.preloadReady;let x=c},5187:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return z}});var n=l(3342),a=l(1201),i=l(9455),s=l(7921),r=l(3956),o=l(124),d=l(9685),u=l(7266),c=l(3958),m=l(9749),x=l(9976),f=l(5819),h=l(8591),p=l.n(h),v=l(7207),j=l.n(v),g=l(2239),b=l(8469),w=l(5109),y=l(8005),N=e=>{let{onClose:t,...l}=e,{modelBomInfo:a=""}=l,s=a&&JSON.parse(a),r=(s||[]).sort((e,t)=>"REFERENCE"===e.tagType&&"REFERENCE"!==t.tagType?-1:"REFERENCE"!==e.tagType&&"REFERENCE"===t.tagType?1:0),o=[],d="graph TD\n";(r||[]).forEach((e,t)=>{let{flowName:l,childFlowIds:n}=e;d+="".concat(t+1,'["').concat(l,'"]\n'),o.push("style ".concat(t+1," color:black,fill:#F1F1F1,stroke:black\n")),n&&n.length>0&&n.forEach(e=>{let l=r.findIndex(t=>t.flowId===e);-1!==l&&(d+="".concat(l+1," --> ").concat(t+1,"\n"),o.push("style ".concat(l+1," color:black,fill:#F1F1F1,stroke:black\n")))})});let u=[...new Set(o||[])].toString().replace(/,style/g," style"),c="".concat(d,"\n").concat(u);return(0,n.jsx)(i.u_,{...l,title:"查看BOM信息",onClose:t,children:(0,n.jsx)("div",{className:"flex flex-col gap-5 w-full min-w-[40rem] overflow-hidden",children:(0,n.jsxs)("div",{className:"flex flex-col gap-5 w-full flex-1 max-h-mc px-5 py-[1px] overflow-y-auto",children:[(0,n.jsx)(E,{tit:"BOM结构",value:(0,n.jsx)(w.b,{data:c,className:"flex justify-center  w-[800px] h-[200px] bg-[#F1F1F1]"})}),(0,n.jsx)(E,{tit:"Part Number信息",value:null}),(r||[]).map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-row gap-10 p-0 ",children:[(0,n.jsx)("div",{className:"w-[200px] text-base text-[#666666] ",children:e.flowName}),(0,n.jsx)("div",{className:"flex flex-wrap flex-shrink w-[30rem] items-center ",children:((null==e?void 0:e.partNumbers)||[]).map((e,t)=>(0,n.jsx)("div",{className:"flex max-w-lg items-center bg-[#F1F1F1] h-6   mb-[10px] rounded ml-5  ",children:(0,n.jsxs)("div",{className:" w-full mx-[10px] items-center  font-normal   ","data-tooltip-id":"tooltip","data-tooltip-content":(0,y.iT)(e,10),children:["PN : ",(0,f.lS)(e,8,8)]})},"value_".concat(t)))})]},"info_".concat(t)))]})})})};function _(e){var t,l,a,s;let{ps:r,...o}=e,[d,u]=(0,g.Z)(!1);return(0,n.jsxs)(i.u_,{title:r.name,...o,children:[(0,n.jsxs)("div",{className:"flex flex-col gap-5 w-full min-w-[40rem] px-5 py-[1px] max-h-mc overflow-y-auto",children:[(0,n.jsx)(E,{tit:"UID",value:r.uuid||"-"}),(0,n.jsx)(E,{tit:"版本",value:r.version||"-"}),(0,n.jsx)(E,{tit:"描述",value:r.description||"-"}),(0,n.jsx)(E,{tit:"状态",value:(0,n.jsx)(k,{status:r.state})}),(0,n.jsx)(E,{tit:"变更人",value:(null===(t=r.updateUser)||void 0===t?void 0:t.name)||"-"}),(0,n.jsx)(E,{tit:"产品系统LCA文件",value:(0,n.jsx)(S,{modelId:null===(l=r.model)||void 0===l?void 0:l.id,modelStatus:null===(a=r.model)||void 0===a?void 0:a.state,isRead:!0})}),(0,n.jsx)(E,{tit:"实景参数列表",value:(0,n.jsx)(C,{action:"查看",onClick:()=>u(!0)})}),(0,n.jsx)(T,{organization:r.org})]}),d&&(0,n.jsx)(b.d,{data:null===(s=r.model)||void 0===s?void 0:s.paramDetail,onClose:()=>u(!1)})]})}function k(e){let{status:t}=e;return j().isNil(t)?(0,n.jsx)("div",{className:"text-base font-normal leading-none text-neutral-400",children:"草稿"}):(0,n.jsx)("div",{className:p()("w-min whitespace-nowrap h-6 px-2.5 py-1 bg-opacity-10 rounded justify-start items-center gap-2.5 inline-flex",{"bg-rose-500":1!==t,"bg-green-600":1===t}),children:(0,n.jsx)("div",{className:p()("text-green-600 text-base font-normal leading-none",{"text-rose-500":1!==t,"text-green-600":1===t}),children:1===t?"当前使用":"过去版本"})})}function C(e){let{action:t,onClick:l,to:a}=e;return a?(0,n.jsx)("a",{href:a,className:"w-min whitespace-nowrap h-6 px-2.5 py-1 bg-zinc-100 rounded text-black text-base font-normal leading-none",children:t}):(0,n.jsx)("div",{className:"w-min whitespace-nowrap h-6 px-2.5 py-1 bg-zinc-100 rounded justify-start items-center gap-2.5 inline-flex cursor-pointer",onClick:l,children:(0,n.jsx)("div",{className:"text-base font-normal leading-none text-black",children:t})})}function S(e){let{psId:t,disableSelectFile:l=!1,openNewTab:a=!1,hiddenUpdate:i,modelId:s,isNew:r,isRead:o,modelStatus:u,file:c,onFileChange:m,btnText:x="上传模型"}=e,h=(0,d.useRef)(null),p=()=>1!==u?(0,n.jsx)("div",{className:"text-base font-normal leading-none text-amber-500",children:"等待解析"}):(0,n.jsx)(C,{onClick:()=>a?window.open("/model?id=".concat(s),"_blank"):void 0,to:a?void 0:"/model?id=".concat(s),action:"在线查看"});return(0,n.jsxs)("div",{className:"text-neutral-400 text-base font-normal leading-none flex items-center gap-2.5",children:[(0,n.jsx)("input",{ref:h,type:"file",hidden:!0,accept:".zip",onChange:m}),!o&&(0,f.lS)(null==c?void 0:c.name,10,10),o?p():r?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(C,{action:x,onClick:e=>{var t;l||null===(t=h.current)||void 0===t||t.click()}})}):(0,n.jsx)(n.Fragment,{children:!c&&p()})]})}function E(e){let t="string"==typeof e.value||"number"==typeof e.value;return(0,n.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,n.jsxs)("div",{className:"text-base font-normal leading-normal text-black",children:[e.tit,": "]}),t?(0,n.jsx)("div",{className:"text-base font-normal leading-none text-neutral-400",children:e.value}):e.value]})}function F(e){let{defaultValue:t,...l}=e;return(0,n.jsx)("input",{type:"text",className:"w-full px-5 py-[15px] bg-gray-28 rounded-lg border border-neutral-200 justify-start items-start gap-2.5 inline-flex text-black text-base font-normal leading-none",...l})}function T(e){let{userData:t}=(0,c.oR)(),l=e.organization||(null==t?void 0:t.organization);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E,{tit:"组织名称",value:(null==l?void 0:l.name)||"-"}),(0,n.jsx)(E,{tit:"组织编号",value:(null==l?void 0:l.serialNumber)||"-"})]})}function I(e){var t,l,a,s;let{psId:r,onSuccess:o,...c}=e,{data:f,isLoading:h,error:p}=(0,m.Kv)(r,6e4),[v,j]=(0,d.useState)(""),w=(0,d.useRef)(!0);(0,d.useEffect)(()=>{f&&w.current&&(j(f.description||""),w.current=!1)},[f]),(0,d.useEffect)(()=>{p&&c.onClose&&c.onClose()},[p]);let[y,k]=(0,d.useState)(!1),[F,I]=(0,d.useState)(null),[R,O]=(0,d.useState)(!1),P=(0,d.useCallback)(e=>{var t;I(null===(t=e.target.files)||void 0===t?void 0:t.item(0))},[]),[D,M]=(0,g.Z)(!1),[z,A]=(0,d.useState)(),L=(0,x.n)();return(0,n.jsxs)(i.u_,{...c,children:[h&&!f&&(0,n.jsx)(u.g,{className:"min-h-[100px]"}),f&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-5  w-full min-w-[40rem] px-5 py-[1px] max-h-mc overflow-y-auto",children:[(0,n.jsx)(E,{tit:"产品系统ID",value:f.uuid||"-"}),(0,n.jsx)(E,{tit:"描述",value:(0,n.jsx)("div",{className:" break-words max-w-[40rem] flex-wrap text-[16px] font-normal text-[#999999]",children:v||"-"})}),(0,n.jsx)(E,{tit:"操作人",value:f.updateUser.name||"-"}),(0,n.jsx)(E,{tit:"BOM信息",value:(0,n.jsx)(C,{action:"查看",onClick:()=>O(!0)})}),(0,n.jsx)(E,{tit:"实景参数列表",value:(0,n.jsx)(C,{action:"查看",onClick:()=>M(!0)})}),(0,n.jsx)(E,{tit:"产品系统LCA文件",value:(0,n.jsx)(S,{modelId:null===(t=f.model)||void 0===t?void 0:t.id,disableSelectFile:y,modelStatus:null===(l=f.model)||void 0===l?void 0:l.state,hiddenUpdate:L,file:F,onFileChange:P})}),(0,n.jsx)(T,{organization:null==f?void 0:f.org})]})}),D&&(0,n.jsx)(b.d,{header:["参数名","过程名称","参考值"],data:null==f?void 0:null===(a=f.model)||void 0===a?void 0:a.paramDetail,onClose:()=>M(!1)}),z&&(0,n.jsx)(_,{onClose:()=>A(void 0),ps:z}),R&&(0,n.jsx)(N,{modelBomInfo:null==f?void 0:null===(s=f.model)||void 0===s?void 0:s.modelBomInfo,onClose:()=>O(!1)})]})}var R=l(5631),O=l(1844),P=l(4956),D=l(2957);function M(e){let{onSuccess:t,onClose:l,...s}=e,[r,o]=(0,d.useState)(""),[u,c]=(0,d.useState)(!1),[m,x]=(0,d.useState)(0),[h,p]=(0,d.useState)(null),[v,j]=(0,d.useState)("upload"),g=!h,[w,y]=(0,d.useState)({id:0,modelBomInfo:"",paramDetail:"",modelName:""}),[_,k]=(0,d.useState)(!1),[T,I]=(0,d.useState)(!1),M=(0,d.useCallback)(e=>{var t;p(null===(t=e.target.files)||void 0===t?void 0:t.item(0))},[]),z=(0,d.useRef)(),A=(0,d.useCallback)(()=>{var e;null===(e=z.current)||void 0===e||e.abort(),l&&l()},[l]),L=()=>{c(!1),x(0)},B=(0,D.o)(),H=async e=>{for(;;){if(await (0,f._v)(5e3),!B.current)return;let t=await (0,O.Yp)(e).catch(()=>void 0);if(x(e=>Math.min(e+10,100)),t&&1===t.state&&t.modelBomInfo)return t}},U=()=>{let e=new FormData;e.append("file",h),z.current=new AbortController,(0,O.av)(e,{signal:z.current.signal,onUploadProgress:e=>{x(Math.min(Math.round(100*(e.progress||0)),60))}}).then(H).then(e=>{e&&(y(e),j("add"),L())}).catch(()=>{L()})},V=(0,R.R)(()=>{g||("upload"===v?u||(c(!0),U()):(0,O.bc)({name:w.modelName,description:r,modelId:w.id}).then(()=>{t&&t(),A()}).catch(e=>{console.log("err",e)}))});return(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(i.u_,{...s,title:"新建产品系统",onClose:()=>{A(),L()},children:(0,n.jsxs)("div",{className:"flex flex-col gap-5 w-full min-w-[40rem] overflow-hidden",children:[(0,n.jsx)("div",{className:"flex flex-col gap-5 w-full flex-1 max-h-mc px-5 py-[1px] overflow-y-auto",children:u?(0,n.jsx)(P.E,{value:m,className:"my-5 overflow-hidden rounded-lg"}):"upload"===v?(0,n.jsx)(E,{tit:"产品系统LCA文件",value:(0,n.jsx)(S,{isNew:!0,disableSelectFile:u,file:h,onFileChange:M,btnText:"选择模型"})}):(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(E,{tit:"产品系统名称",value:null==w?void 0:w.modelName}),(0,n.jsx)(E,{tit:"BOM信息",value:(0,n.jsx)(C,{action:"查看",onClick:()=>k(!0)})}),(0,n.jsx)(E,{tit:"实景参数列表",value:(0,n.jsx)(C,{action:"查看",onClick:()=>I(!0)})}),(0,n.jsx)(E,{tit:"产品系统LCA文件",value:(0,n.jsx)(S,{modelStatus:u?0:1,modelId:w.id,openNewTab:!0,onFileChange:M})}),(0,n.jsx)(E,{tit:"描述",value:(0,n.jsx)(F,{maxLength:100,value:r,onChange:e=>o(e.target.value)})})]})}),(0,n.jsx)("div",{className:"flex flex-shrink-0 w-full gap-5 px-5",children:!u&&(0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(a.u,{defStyle:"btn-primary-1",className:"flex-1",onClick:()=>{A(),L()},children:"取消"}),(0,n.jsx)(a.u,{className:"flex-1",onClick:V,disabled:g,children:"upload"===v?"上传":"确定"})]})})]})}),T&&(0,n.jsx)(b.d,{header:["参数名","过程名称","参考值"],data:null==w?void 0:w.paramDetail,onClose:()=>I(!1)}),_&&(0,n.jsx)(N,{...w,onClose:()=>k(!1)})]})}var z=function(){var e,t,l,c;let[m,h]=(0,d.useState)(null),[v,j]=(0,d.useState)(null),[g,b]=(0,d.useState)(),[w,N]=(0,d.useState)(null),[_,k]=(0,d.useState)(!1),[C,S]=(0,d.useState)(1),[E,F]=(0,d.useState)(-1),[T,R]=(0,d.useState)(0),[P,D]=(0,d.useState)({}),[z,A]=(0,d.useState)([]),[L,B]=(0,d.useState)(!0),H=async()=>{let e=await (0,O.vz)(C);D(e),B(!1)};(0,d.useEffect)(()=>{let e=!1,t=async()=>{for(;;){if(e)return;try{await H(),await (0,f._v)(1e4)}catch(e){continue}}};return t(),()=>{e=!0}},[]);let U=(0,d.useMemo)(()=>[{title:"产品系统",dataIndex:"name",width:"200px",render:e=>(0,n.jsx)("span",{"data-tooltip-id":"tooltip","data-tooltip-place":"top-start","data-tooltip-content":(0,y.iT)(e,20),className:"w-[200px] font-normal  text-lg leading-[27px] truncate inline-block",children:e})},{title:"产品系统ID",dataIndex:"uuid",width:"15rem",render:e=>(0,n.jsx)("span",{"data-tooltip-id":"tooltip","data-tooltip-content":e,className:"text-lg w-[15rem] truncate inline-block font-normal leading-[27px]",children:(0,f.lS)(e,8,8)})},{title:"操作人",dataIndex:"name",width:"8rem",render:(e,t)=>(0,n.jsx)("span",{className:"w-[8rem] text-lg truncate inline-block font-normal leading-[27px]",children:t.updateUser.name})},{title:"描述",dataIndex:"description",width:"14rem",render:e=>(0,n.jsx)("div",{"data-tooltip-content":(0,y.iT)(e,11),"data-tooltip-id":"tooltip",className:"w-[14rem] text-lg truncate inline-block font-normal leading-[27px]",children:e||"-"})},{title:"上传时间",dataIndex:"createTime",width:"13rem",render:e=>(0,n.jsx)("span",{className:"w-[13rem] text-lg truncate inline-block font-normal leading-[27px]",children:e})},{title:"",width:"20rem",render:(e,t)=>(0,n.jsx)("div",{className:"flex justify-between flex-1 ml-10 text-green-2 break-keep",children:(0,n.jsx)("div",{className:"flex items-center font-normal justify-center cursor-pointer text-lg leading-[27px]",onClick:()=>b(t),children:"查看"})})}],[]),V=(0,d.useMemo)(()=>[{title:"实景输入项",dataIndex:"context",width:"20%"},{title:"过程名称",dataIndex:"parameter",width:"30%"},{title:"参考值",dataIndex:"amount",width:"20%"},{title:"不确定性",dataIndex:"uncertainty",emptyText:"-",width:"30%"}],[]),Z=async e=>{let t="更改状态";N({title:t,loading:!0}),await (0,O.pF)(m.id,e),R(T+1),N({title:t,loading:!1,resultText:"操作成功"}),h(null)},K=(0,x.b)(),G=()=>{S(1),1===C&&H()};return(0,n.jsxs)(o.m,{isNew:!0,canBack:!0,link:{pathName:"/tools/tools",homeTitle:"产品碳足迹工具集",currentTitle:"产品碳足迹模型管理工具"},className:"flex flex-col justify-between flex-1 pb-12 text-black ",children:[(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)("h3",{className:"flex items-center justify-between text-2xl font-semibold",children:[(0,n.jsx)("span",{children:"我的产品系统"}),K&&(0,n.jsx)(a.z,{onClick:()=>k(!0),className:p()("w-40 text-lg font-normal text-white rounded-lg bg-green-2 h-11 hover:bg-green-28"),children:"新建产品系统"})]}),(0,n.jsx)("div",{className:"w-full p-5 mt-5 bg-white rounded-2xl",children:(0,n.jsx)("div",{className:"pb-6 mt-5 overflow-x-auto",children:(0,n.jsx)("div",{className:"min-h-[20.25rem] text-base leading-[1.625rem] min-w-[68.25rem]",children:(0,n.jsx)(r.i,{loading:L,columns:U,columnsHeight:"h-[3.125rem]",mouseHoverKey:"id",data:(null==P?void 0:P.records)||[],columnsClassName:" cursor-pointer ",headerClassName:{background:"#fff",fontWeight:"700",fontSize:"18px",lineHeight:"27px"}})})})})]}),(0,n.jsx)(s.t,{onChange:e=>{S(e),(0,y.k3)(),B(!0)},className:"my-8",total:(null==P?void 0:P.total)||0,pgSize:10,pgNum:C}),null!==m&&(0,n.jsx)(i.u_,{title:"更改状态",onClose:()=>h(null),children:(0,n.jsx)("div",{className:"flex",children:(null==w?void 0:w.loading)?(0,n.jsx)(u.g,{}):(0,n.jsxs)("div",{className:"flex flex-1",children:[m.state>-2&&(0,n.jsx)(a.z,{onClick:()=>Z(1===m.state?0:1),className:"flex-1 w-full text-lg text-white rounded-lg bg-green-2 h-11",children:1===m.state?"弃用":"激活"}),-1===m.state&&(0,n.jsx)(a.z,{onClick:()=>Z(-2),className:"flex-1 w-full ml-5 text-lg border-2 rounded-lg border-green-2 bg-green-2/10 text-green-2 hover:bg-green-2/20 h-11",children:"删除"})]})})}),!!v&&(0,n.jsx)(i.u_,{title:v.modelName+"模型中的实景输入项",onClose:()=>j(null),children:(0,n.jsxs)("div",{className:"flex w-[60rem] min-h-[16rem] flex-col pb-2",children:[(0,n.jsx)("ul",{className:"flex mb-1",children:V.map((e,t)=>(0,n.jsx)("li",{className:"px-3 text-lg font-bold",style:{width:e.width},children:e.title},"columns".concat(t)))}),(0,n.jsx)("div",{className:"max-h-[15rem] min-h-[5rem] overflow-y-auto",children:(0,n.jsx)(r.i,{size:"big",hiddenHeader:!0,columns:V,data:v.paramDetail})})]})}),w&&(0,n.jsx)(i.u_,{title:(null==w?void 0:w.title)||"操作",onClose:()=>N(null),children:(0,n.jsx)("div",{className:"pb-2 text-center",children:w.loading?(0,n.jsx)(u.g,{}):(0,n.jsx)("span",{children:w.resultText})})}),_&&(0,n.jsx)(M,{onClose:()=>k(!1),onSuccess:()=>G()}),g&&(0,n.jsx)(I,{psId:g.id,title:g.name,onClose:()=>b(void 0),onSuccess:()=>G()}),E>-1&&(0,n.jsx)(i.u_,{title:"查看产品",onClose:()=>F(-1),children:(0,n.jsxs)("ul",{className:"text-lg max-w-[32rem]",children:[(0,n.jsxs)("li",{className:"flex",children:[(0,n.jsx)("label",{className:"inline-block min-w-[5.625rem]",children:"产品名称 :"}),(0,n.jsx)("span",{className:"break-all text-gray-6",children:null===(e=z[E])||void 0===e?void 0:e.text})]}),(0,n.jsxs)("li",{className:"my-5",children:[(0,n.jsx)("label",{className:"inline-block w-[5.625rem]",children:"产品类型 :"}),(0,n.jsx)("span",{className:"text-gray-6",children:null===(t=z[E])||void 0===t?void 0:t.type})]}),(0,n.jsxs)("li",{className:"flex",children:[(0,n.jsx)("label",{className:"inline-block min-w-[5.625rem]",children:"描述 :"}),(0,n.jsx)("span",{className:"break-all text-gray-6",children:(null===(l=z[E])||void 0===l?void 0:l.desc)?null===(c=z[E])||void 0===c?void 0:c.desc:"-"})]})]})})]})}},1083:function(e,t,l){e.exports=l(1362)}},function(e){e.O(0,[3268,1271,7588,7038,8635,6933,8881,8149,9774,2888,179],function(){return e(e.s=6220)}),_N_E=e.O()}]);